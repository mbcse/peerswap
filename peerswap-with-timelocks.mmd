sequenceDiagram
    participant U1 as User A (Asker)
    participant U2 as User B (Fulfiller)
    participant SC as Smart Contracts
    participant R as Relayer
    participant CA as Chain A (Sepolia)
    participant CB as Chain B (Base Sepolia)

    U1->>SC: 1. Create Swap
    SC->>CA: E1: Deploy Source Escrow
    CA->>CA: State: User Funds Locked (Hashlock + Timelock)
    Note over CA: Timelock: 0-24h: Withdrawal Only<br/>24-48h: Withdrawal OR Cancel<br/>48-72h: Withdrawal OR Cancel OR Rescue<br/>72h+: Rescue Only
    
    U2->>SC: 2. Fulfill Swap
    SC->>CB: E2: Deploy Destination Escrow
    CB->>CB: State: Fulfiller Funds Locked (Hashlock + Timelock)
    Note over CB: Same Timelock Stages
    
    R->>SC: 3. Set Fulfiller
    SC->>CA: State: Fulfiller Set
    
    U1->>R: 4. Submit Secret
    R->>CA: E3: Secret Revealed
    CA->>CA: State: Unlock with Secret (Before Timelock Expires)
    R->>CB: E3: Secret Revealed
    CB->>CB: State: Unlock with Secret (Before Timelock Expires)
    
    CA->>U1: 5. User A Gets Tokens
    CB->>U2: 5. User B Gets Tokens
    
    Note over CA,CB: Swap Completed Successfully
    
    Note over CA,CB: Alternative: If Secret Not Revealed<br/>After 24h: User Can Cancel<br/>After 48h: Platform Can Rescue<br/>After 72h: Only Rescue Available
